{
  "meta:license": [
    "Copyright 2018 Adobe Systems Incorporated. All rights reserved.",
    "This work is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license",
    "you may not use this file except in compliance with the License. You may obtain a copy",
    "of the License at https://creativecommons.org/licenses/by/4.0/"
  ],
  "$schema": "http://json-schema.org/draft-06/schema#",
  "$id": "https://ns.adobe.com/experience/offer-management/offer-filter",
  "meta:extends": ["https://ns.adobe.com/experience/decisioning/option-filter"],
  "meta:abstract": false,
  "meta:extensible": true,
  "type": "object",
  "title": "Offer Filter",
  "description": "Filters are used to specify criteria for offer selection by topic or theme. The most common filter mechanism is by the tags that are associated with an offer. In general the offer filter selects a subset of offers from the overall inventory, not based on the use case for the decisioning.",
  "definitions": {
    "offer-filter": {
      "properties": {
        "xdm:filterType": {
          "enum": ["offers", "anyTags", "allTags"],
          "meta:enum": {
            "offers": "The filter directly references offers by their ids. The set of matching offers is enumerated.",
            "anyTags": "The filter is set up using tags and any tag specified in the `xdm:ids` list that has a match with one tag set on an offer is sufficent for the offer to qualify.",
            "allTags": "The filter is set up using tags and all tags specified in the `xdm:ids` list must match one set on a particular offer for the offer to qualify."
          }
        },
        "xdm:ids": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri-reference",
            "description": "An identifier of an XDM entity. The value value refers to an `@id` property of the entity. The type of the entity depends on the filterType value. For instance for filters with `xdm:filterType` value equals `offers` the values reference offers. If the `xdm:filterType` value equals `anyTags` or equals `allTags` then the the values reference tag entities."
          }
        }
      }
    }
  },
  "allOf": [
    {
      "$ref": "https://ns.adobe.com/xdm/data/record"
    },
    {
      "$ref": "https://ns.adobe.com/experience/decisioning/option-filter"
    },
    {
      "$ref": "#/definitions/offer-filter"
    },
    {
      "required": ["xdm:name"]
    }
  ]
}
